# Функциональные требования к дашборду статистики HomeGuru

## Обзор

Дашборд статистики предоставляет административный интерфейс для мониторинга активности пользователей и диалогов в Telegram-боте HomeGuru. Дашборд должен отображать ключевые метрики в реальном времени и предоставлять визуализацию данных для анализа.

**Референс дизайна:** https://ui.shadcn.com/blocks#dashboard-01

---

## 1. Ключевые метрики (Metric Cards)

Дашборд должен отображать 4 карточки с ключевыми метриками:

### 1.1 Total Dialogues
- **Описание:** Общее количество уникальных диалогов (сессий пользователей)
- **Значение:** Числовое значение (например, 1,234)
- **Тренд:** Процент изменения относительно предыдущего периода (например, +12.5%)
- **Дополнительно:** Краткое текстовое пояснение тренда

### 1.2 Active Users
- **Описание:** Количество активных пользователей за выбранный период
- **Значение:** Числовое значение
- **Тренд:** Процент изменения относительно предыдущего периода
- **Дополнительно:** Краткое текстовое пояснение

### 1.3 Avg Messages per Dialogue
- **Описание:** Средняя длина диалога в сообщениях
- **Значение:** Числовое значение с десятичными знаками (например, 45.7)
- **Тренд:** Процент изменения
- **Дополнительно:** Краткое текстовое пояснение

### 1.4 Messages Today
- **Описание:** Общее количество сообщений за текущий день
- **Значение:** Числовое значение
- **Тренд:** Процент изменения относительно предыдущего дня
- **Дополнительно:** Краткое текстовое пояснение

---

## 2. График активности (Time Series Chart)

### 2.1 Основные требования
- Отображение временного ряда активности (количество сообщений или диалогов по датам)
- Плавная кривая с заливкой области под графиком
- Интерактивность: tooltip при наведении на точку графика

### 2.2 Переключатель периода
Пользователь может выбрать один из трех периодов:
- **Day** - последние 24 часа (почасовая разбивка)
- **Week** - последние 7 дней (ежедневная разбивка)
- **Month** - последние 30 дней (ежедневная разбивка)

### 2.3 Формат данных
- Ось X: даты/время
- Ось Y: количество сообщений или диалогов
- Минимум 24 точки данных для периода "day"
- Минимум 7 точек данных для периода "week"
- Минимум 30 точек данных для периода "month"

---

## 3. Последние диалоги (Recent Dialogues)

### 3.1 Описание
Список последних 10 активных диалогов с метаданными.

### 3.2 Отображаемые данные для каждого диалога
- **User ID:** Telegram ID пользователя
- **Username:** Telegram username (если доступен) или "Anonymous"
- **Message Count:** Количество сообщений в диалоге
- **Last Message At:** Время последнего сообщения (в формате "2 hours ago" или "2024-10-17 14:30")

### 3.3 Сортировка
Диалоги отсортированы по времени последнего сообщения (самые свежие сверху).

---

## 4. Топ пользователей (Top Users)

### 4.1 Описание
Список топ-5 самых активных пользователей за выбранный период.

### 4.2 Отображаемые данные для каждого пользователя
- **User ID:** Telegram ID пользователя
- **Username:** Telegram username (если доступен) или "Anonymous"
- **Total Messages:** Общее количество сообщений пользователя
- **Dialogue Count:** Количество диалогов (сессий) пользователя

### 4.3 Сортировка
Пользователи отсортированы по общему количеству сообщений (от большего к меньшему).

---

## 5. Технические требования

### 5.1 Производительность
- Время загрузки данных: не более 2 секунд
- Плавная анимация переходов между периодами
- Отзывчивый интерфейс (responsive design)

### 5.2 Обработка ошибок
- Отображение состояния загрузки (loading spinner)
- Сообщение об ошибке при недоступности API
- Graceful degradation при отсутствии данных

### 5.3 Адаптивность
- Корректное отображение на desktop (1920x1080 и выше)
- Адаптация для планшетов (768px-1024px)
- Мобильная версия (опционально для MVP)

---

## 6. Ограничения MVP

Для первой версии (MVP) **НЕ** требуется:
- Фильтрация по конкретным пользователям
- Экспорт данных в CSV/Excel
- Настройка кастомных периодов
- Детальный просмотр отдельного диалога
- Real-time обновления (WebSocket)
- Аутентификация и авторизация

Эти функции могут быть добавлены в последующих спринтах.

---

## 7. API Contract

Все данные для дашборда предоставляются через единственный API endpoint:

```
GET /stats?period={day|week|month}
```

**Response:** JSON объект со всеми необходимыми данными (см. `src/api/models.py`)

Подробности контракта API см. в документации Swagger UI: http://localhost:8000/docs

